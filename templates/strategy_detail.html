{% extends 'base.html' %}

{% block content %}
<div class="strategy-detail-container">
    <h1>Détails de la stratégie</h1>
    <h2>{{ strategy.name }}</h2>
    <p><strong>Type :</strong> {{ strategy.type }}</p>
    <p><strong>Instruments :</strong> {{ strategy.instruments }}</p>
    <p><strong>Unité de temps :</strong> {{ strategy.timeframe }}</p>
    <p><strong>Type d'entrée :</strong> {{ strategy.entry_type }}</p>
    <p><strong>Type de sortie :</strong> {{ strategy.exit_type }}</p>
    <p><strong>Indicateurs utilisés :</strong> {{ strategy.indicators }}</p>
    <p><strong>Gestion du risque :</strong> {{ strategy.risk }}</p>
    <p><strong>Perte maximale :</strong> {{ strategy.max_loss }}</p>
    <p><strong>Description :</strong> {{ strategy.description }}</p>
    <p><strong>Règles :</strong></p>
    <pre>{{ strategy.rules }}</pre>
    <p><strong>Créé par :</strong> {{ strategy.user.prenom }} {{ strategy.user.nom }}</p>
    <p><strong>Date de création :</strong> {{ strategy.date_creation }}</p>

    <form method="POST" action="{{ url_for('strategy_detail', strategy_id=strategy.id) }}">
        <label for="name">Nom :</label>
        <input type="text" id="name" name="name" value="{{ strategy.name }}" required>

        <label for="type">Type de Stratégie :</label>
        <select id="type" name="type" required>
            <option value="Breakout" {% if strategy.type == 'Breakout' %}selected{% endif %}>Breakout</option>
            <option value="Range" {% if strategy.type == 'Range' %}selected{% endif %}>Range</option>
            <option value="Tendance" {% if strategy.type == 'Tendance' %}selected{% endif %}>Tendance</option>
            <option value="Contre-tendance" {% if strategy.type == 'Contre-tendance' %}selected{% endif %}>Contre-tendance</option>
            <option value="Scalping" {% if strategy.type == 'Scalping' %}selected{% endif %}>Scalping</option>
            <option value="Swing" {% if strategy.type == 'Swing' %}selected{% endif %}>Swing</option>
            <option value="Day trading" {% if strategy.type == 'Day trading' %}selected{% endif %}>Day trading</option>
            <option value="Autre" {% if strategy.type == 'Autre' %}selected{% endif %}>Autre</option>
        </select>

        <label for="instruments">Instruments :</label>
        <input type="text" id="instruments" name="instruments" value="{{ strategy.instruments }}" placeholder="Ex: EUR/USD, GBP/USD">

        <label for="timeframe">Unité de temps :</label>
        <select id="timeframe" name="timeframe" required>
            <option value="M1" {% if strategy.timeframe == 'M1' %}selected{% endif %}>M1</option>
            <option value="M5" {% if strategy.timeframe == 'M5' %}selected{% endif %}>M5</option>
            <option value="M15" {% if strategy.timeframe == 'M15' %}selected{% endif %}>M15</option>
            <option value="M30" {% if strategy.timeframe == 'M30' %}selected{% endif %}>M30</option>
            <option value="H1" {% if strategy.timeframe == 'H1' %}selected{% endif %}>H1</option>
            <option value="H4" {% if strategy.timeframe == 'H4' %}selected{% endif %}>H4</option>
            <option value="D1" {% if strategy.timeframe == 'D1' %}selected{% endif %}>D1</option>
            <option value="W1" {% if strategy.timeframe == 'W1' %}selected{% endif %}>W1</option>
            <option value="MN" {% if strategy.timeframe == 'MN' %}selected{% endif %}>MN</option>
        </select>

        <label>Type d'entrée :</label>
        <select id="entry_type" name="entry_type">
            <option value="Market" {% if strategy.entry_type == 'Market' %}selected{% endif %}>Market</option>
            <option value="Limit" {% if strategy.entry_type == 'Limit' %}selected{% endif %}>Limit</option>
            <option value="Stop" {% if strategy.entry_type == 'Stop' %}selected{% endif %}>Stop</option>
        </select>

        <label for="exit_type">Type de sortie :</label>
        <input type="text" id="exit_type" name="exit_type" value="{{ strategy.exit_type }}" placeholder="Ex: TP, SL, Trailing Stop">

        <label for="indicators">Indicateurs utilisés :</label>
        <input type="text" id="indicators" name="indicators" value="{{ strategy.indicators }}" placeholder="Ex: RSI, MACD, Moyenne mobile">

        <label for="risk">Gestion du risque :</label>
        <select id="risk" name="risk" required>
            <option value="1%" {% if strategy.risk == '1%' %}selected{% endif %}>1% par trade</option>
            <option value="2%" {% if strategy.risk == '2%' %}selected{% endif %}>2% par trade</option>
            <option value="3%" {% if strategy.risk == '3%' %}selected{% endif %}>3% par trade</option>
            <option value="autre" {% if strategy.risk == 'autre' %}selected{% endif %}>Autre</option>
        </select>

        <label for="max_loss">Perte Maximale :</label>
        <input type="number" id="max_loss" name="max_loss" value="{{ strategy.max_loss }}">

        <label for="description">Description complémentaire :</label>
        <textarea id="description" name="description">{{ strategy.description }}</textarea>

        <label for="rules">Règles :</label>
        <textarea id="rules" name="rules" required>{{ strategy.rules }}</textarea>

        <button type="submit" class="btn btn-primary">Mettre à jour</button>
    </form>
</div>

<style>
.strategy-detail-container {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 10px;
    background-color: var(--background-color, #f9f9f9);
    color: var(--text-color, #000);
}
.strategy-detail-container h1 {
    text-align: center;
    margin-bottom: 20px;
}
.strategy-detail-container form {
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.strategy-detail-container form label {
    font-weight: bold;
}
.strategy-detail-container form input,
.strategy-detail-container form textarea {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: var(--input-background-color, #fff);
    color: var(--input-text-color, #000);
}
.strategy-detail-container form button {
    padding: 10px;
    background-color: var(--button-background-color, #007bff);
    color: var(--button-text-color, white);
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
.strategy-detail-container form button:hover {
    background-color: var(--button-hover-background-color, #0056b3);
}
</style>
{% endblock %}